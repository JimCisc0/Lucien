
     var Discord= require("./discord.js");
     const readline = require('readline');
     const fichier = require('fs');

exports.add= function(word,channel){
    found  = false;
    var w = new String(word);
  
    const rl = readline.createInterface({
    input: fichier.createReadStream('wordlist'),
    crlfDelay: Infinity
     });

  

   rl.on('line', (line) => {
   var l =new String(line); 
   
   
   if(((l.toUpperCase()=== w.toUpperCase())&&(found==false))){
     found = true;
     console.log("mot déjà existant");
     let serverembed = new Discord.RichEmbed()
     .setDescription("Mot non autorisé")
     .setColor("#FE0101")
     .addField("mot déjà banni" , w )
     
      return channel.send(serverembed)
      
    } }).on('close',function(){
        if((found==false)){
    fichier.appendFile("wordlist", "\n" + w , function(err) {
    if(err) {
        
        return console.log(err);
        
     };

     let serverembed = new Discord.RichEmbed()
     .setDescription("Mot non autorisé")
     .setColor("#15f153")
     .addField("le mot est ajouté à la liste des mots bannis" , w )
     
      return channel.send(serverembed)
    });

    
}
})};


exports.surveille= function(message){

    var mes = new String(message.content);

    const rl = readline.createInterface({
        input: fichier.createReadStream('wordlist'),
        crlfDelay: Infinity
         });
    
       rl.on('line', (line) => {
           if(!(line==="")){

       var l =new String(line); 
       var pos = mes.indexOf(l);
       
       if(pos != -1){

        let kUser = message.guild.member(message.author);
        if(!kUser) return message.channel.send("Can't find user!");
        if(kUser.hasPermission("MANAGE_MESSAGES")) return message.channel.send("Cette personne ne peut être kick");

        let kickEmbed = new Discord.RichEmbed()
        .setDescription("~Kick~")
        .setColor("#e56b00")
        .addField("Kicked User", `${kUser}`)
        .addField("Kicked By", `lucien`)
        .addField("Kicked In", message.channel)
        .addField("Tiime", message.createdAt)
        .addField("Reason", "\""+mes + "\"");
    
        let kickChannel = message.guild.channels.find(`name`, "log");
        if(!kickChannel) return message.channel.send("Je ne peux pas trouver le chan log");
    
        message.guild.member(kUser).kick("ecriture du mot " + mes);
        kickChannel.send(kickEmbed);
    
        return;
            message.delete().then(msg => console.log(`Deleted message from ${msg.author.username}`))
            .catch(console.error);

            message.reply('pas de ça ici, garde ça pour l\'enfer!')
            .then(sent => console.log(`Sent a reply to ${sent.author.username}`))
            .catch(console.error);
           
       }


       
           }
       

});
};


exports.blacklister= function(){

}